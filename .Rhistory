knitr::opts_chunk$set(warning = FALSE, message = FALSE)
a <- 1
b <- 3
a.post <- C1 + C2 + a
rm(list=ls())
library(tibble)
library(ggplot2)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
my.qbinom <- function(u, N, pi){
p <- sapply(c(0:N), FUN=function(n) choose(N, n)*pi^n*(1-pi)^{N-n})
cdf <- cumsum(p)
return(findInterval(u, cdf))
}
my.rbinom <- function(N, pi, n.iter=1){
U <- runif(n=n.iter, min=0, max=1)
res <- sapply(U, FUN=function(u) my.qbinom(u,N, pi))
return(res)
}
n.iter <- 10000
N <- 125
pi <- 0.15
generated.C1 <- my.rbinom(N, pi, n.iter)
resultats <- data.frame(n=1:n.iter, valeurs=factor(generated.C1, levels = 0:N))
#frequence theorique
freq_theo =dbinom(0:N, N, pi)
#calcul de la frequence empirique
freq_emp <- c()
for (k in 0:N){
freq_emp <- c(freq_emp, mean(generated.C1==k))
}
freq_binom <- tibble( x=0:N, freq_emp=freq_emp, freq_theo=freq_theo)
#Représentation graphique
ggplot(freq_binom) + #Tableau représenter
aes(x = x) + #Abscisse commune
geom_col(mapping = aes(y = freq_emp), #Ordonne des frquences empiriques
width = 0.2, fill = "lightblue") +
geom_point(aes(y = freq_theo), #On ajoute le point des frquences thoriques
shape = 3, col = "red", size = 3) +
xlim(0, 40) +
labs(y = "Frequence", x = "Nombre de succes")
capture.sim <- function(N, pi){
C1 <- my.rbinom(N=N, pi=pi)
C20 <- my.rbinom(N=N-C1, pi=pi)
C21 <- my.rbinom(N=C1, pi=pi)
return(tibble(C1=C1, C20=C20, C21=C21))
}
capture.sim(N, pi)
C1
C2
